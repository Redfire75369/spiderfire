// @flow

declare module "fs" {
	declare export class FileHandle {
		read(): Promise<Uint8Array>;
		readSync(): Uint8Array;

		readString(): Promise<string>;
		readStringSync(): string;

		write(source: BufferSource): Promise<void>;
		writeSync(source: BufferSource): void;
	}

	declare export interface OpenOptions {
		read?: boolean,
		write?: boolean,
		append?: boolean,
		create?: boolean,
		createNew?: boolean,
	}

	declare export function open(path: string, options?: OpenOptions): Promise<FileHandle>;

	declare export function create(path: string): Promise<FileHandle>;

	declare export function readDir(path: string): Promise<string[]>;

	declare export function createDir(path: string, recursive?: boolean): Promise<void>;

	declare export function remove(path: string, recursive?: boolean): Promise<void>;

	declare export function copy(from: string, to: string): Promise<number>;

	declare export function rename(from: string, to: string): Promise<void>;

	declare export function symlink(original: string, link: string): Promise<void>;

	declare export function link(original: string, link: string): Promise<void>;

	declare export var sync: {
		open(path: string, options?: OpenOptions): FileHandle;
		create(path: string): FileHandle;

		readDir(path: string): string[],
		createDir(path: string, recursive?: boolean): void,
		remove(path: string, recursive?: boolean): void,
		copy(from: string, to: string): number,
		rename(from: string, to: string): void,
		symlink(original: string, link: string): void,
		link(original: string, link: string): void,
	};

	declare export default {
		FileHandle: typeof FileHandle,

		OpenOptions: typeof OpenOptions,
		open: typeof open,
		create: typeof create,

		readDir: typeof readDir,
		createDir: typeof createDir,
		remove: typeof remove,
		copy: typeof copy,
		rename: typeof rename,
		symlink: typeof symlink,
		link: typeof link,

		sync: typeof sync,
	}
}

declare module "fs/sync" {
	import {FileHandle, OpenOptions} from "fs";

	declare export function open(path: string, options?: OpenOptions): FileHandle;

	declare export function create(path: string): FileHandle;

	declare export function readDir(path: string): string[];

	declare export function createDir(path: string, recursive?: boolean): void;

	declare export function remove(path: string, recursive?: boolean): void;

	declare export function copy(from: string, to: string): number;

	declare export function rename(from: string, to: string): void;

	declare export function symlink(original: string, link: string): void;

	declare export function link(original: string, link: string): void;
}
